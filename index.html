<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- ä¿®æ”¹ç€è¦½å™¨æ¨™ç±¤é æ¨™é¡Œ -->
    <title>ZC é–€å¸‚ç¸¾æ•ˆç³»çµ±</title>

    <!-- åŠ å…¥ OG æ¨™ç±¤ï¼Œç¢ºä¿ LINE åˆ†äº«æ™‚é¡¯ç¤ºæ­£ç¢ºåç¨± -->
    <meta property="og:title" content="ZC é–€å¸‚ç¸¾æ•ˆç³»çµ±">
    <meta property="og:description" content="ZC å°ˆç”¨æ¥­ç¸¾å›å ±èˆ‡é–€å¸‚ç®¡ç†ç³»çµ±">
    <meta property="og:type" content="website">
    <!-- å¦‚æœæœ‰ Logo åœ–ç‰‡ URL å¯ä»¥æ”¾åœ¨é€™è£¡ -->
    <meta property="og:image" content="https://raw.githubusercontent.com/lucide-react/lucide/main/icons/pink-heart.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 100%); 
            font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            min-height: 100vh;
        }
        .card { 
            background: rgba(255, 255, 255, 0.95); 
            border-radius: 24px; 
            box-shadow: 0 10px 25px -5px rgba(236, 72, 153, 0.1), 0 8px 10px -6px rgba(236, 72, 153, 0.1);
            backdrop-filter: blur(8px);
        }
        label { font-weight: 600; color: #4b5563; margin-bottom: 0.4rem; display: flex; align-items: center; gap: 4px; }
        input, select, textarea { 
            width: 100%; padding: 0.85rem; border: 1.5px solid #f9a8d4; border-radius: 14px; margin-bottom: 1rem; font-size: 16px;
            transition: all 0.2s;
            background-color: white;
        }
        input:focus, textarea:focus { outline: none; border-color: #ec4899; box-shadow: 0 0 0 4px rgba(236, 72, 153, 0.15); transform: translateY(-1px); }
        .section-title { 
            display: flex; align-items: center; gap: 8px;
            margin: 2rem 0 1.2rem 0; font-size: 1.2rem; font-weight: 800; color: #be185d; 
        }
        .perf-row { 
            background: linear-gradient(to right, #ffffff, #fff1f2); 
            padding: 1.5rem; border-radius: 20px; margin-bottom: 1.2rem; 
            border: 1px solid #fbcfe8;
            position: relative;
        }
        #loadingOverlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 50; align-items: center; justify-content: center; color: white; flex-direction: column; backdrop-filter: blur(4px); }
        optgroup { font-weight: bold; color: #ec4899; font-style: normal; }
        .cheer-msg { font-size: 0.85rem; color: #db2777; font-weight: bold; margin-top: -0.5rem; margin-bottom: 0.5rem; display: none; }
        
        .btn-primary {
            background: linear-gradient(135deg, #ec4899 0%, #be185d 100%);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(236, 72, 153, 0.4); }
    </style>
</head>
<body class="p-4 md:p-8">
    <div id="loadingOverlay">
        <div class="animate-spin rounded-full h-16 w-16 border-4 border-pink-500 border-t-transparent mb-4"></div>
        <p class="font-bold text-xl text-white">æ­£åœ¨åŒæ­¥æ•¸æ“š âœ¨</p>
    </div>

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-extrabold text-gray-800 tracking-tight">ã€ŠZCã€‹é–€å¸‚ç¸¾æ•ˆç³»çµ± ğŸ€</h1>
            <p class="text-pink-600 font-medium mt-2">è¾›è‹¦äº†ï¼æ¯ä¸€ä»½è¨˜éŒ„éƒ½æ˜¯æˆé•·çš„è¶³è·¡ âœ¨</p>
        </header>

        <form id="storeForm" class="card p-6 md:p-10 mb-8">
            <!-- åŸºæœ¬è³‡è¨Š -->
            <div class="section-title"><span>ğŸ“</span> åŸºæœ¬è³‡è¨Š</div>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-5">
                <div>
                    <label>å›å ±å–®ä½</label>
                    <select name="store_name" id="store_name" required>
                        <option value="">é¸æ“‡å–®ä½</option>
                        <option value="ä¸­å±±é–€å¸‚">ğŸ›ï¸ ä¸­å±±é–€å¸‚</option>
                        <option value="ä¸­åŸé–€å¸‚">ğŸ¡ ä¸­åŸé–€å¸‚</option>
                        <option value="æ–°ç«¹é–€å¸‚">ğŸš„ æ–°ç«¹é–€å¸‚</option>
                        <option value="å€‰å„²ä¸­å¿ƒ">ğŸ“¦ å€‰å„²ä¸­å¿ƒ</option>
                    </select>
                </div>
                <div><label>æ—¥æœŸ</label><input type="date" name="date" id="date" required></div>
                <div>
                    <label>æ˜ŸæœŸ</label>
                    <select name="weekday" id="weekday">
                        <option value="ä¸€">æ˜ŸæœŸä¸€</option><option value="äºŒ">æ˜ŸæœŸäºŒ</option><option value="ä¸‰">æ˜ŸæœŸä¸‰</option>
                        <option value="å››">æ˜ŸæœŸå››</option><option value="äº”">æ˜ŸæœŸäº”</option><option value="å…­">æ˜ŸæœŸå…­</option>
                        <option value="æ—¥">æ˜ŸæœŸæ—¥</option>
                    </select>
                </div>
                <div><label>ä»Šæ—¥é€²åº—äººæµ</label><input type="number" name="visitor_count" value="0"></div>
            </div>

            <!-- ä»Šæ—¥æ•¸æ“š -->
            <div class="section-title"><span>ğŸ“Š</span> ä»Šæ—¥æ•¸æ“šç¸½è¨ˆ</div>
            <div class="grid grid-cols-3 gap-5">
                <div><label>ç¸½ä»¶æ•¸ ğŸ§º</label><input type="number" name="total_items" required placeholder="ä»¶"></div>
                <div><label>ç¸½ç­†æ•¸ ğŸ§¾</label><input type="number" name="total_orders" required placeholder="ç­†"></div>
                <div><label>å…¨åº—æ–°å¢ VIP ğŸ’</label><input type="number" name="total_vip_all" value="0"></div>
            </div>

            <!-- äººå“¡ç¸¾æ•ˆ -->
            <div class="section-title"><span>ğŸ’ƒ</span> äººå“¡ç¸¾æ•ˆæ˜ç´°</div>
            <div id="staffContainer">
                <div class="perf-row staff-group">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                        <div>
                            <label>éŠ·å”®äººå“¡</label>
                            <select name="staff_name[]" class="staff-select" required onchange="updateCheer(this)">
                                <option value="">é¸äººå“¡</option>
                                <optgroup label="ä¸­å±±åº— - æ­£è·">
                                    <option value="åº­åº­ zctt">åº­åº­ zctt</option>
                                    <option value="é›¯é›¯ zc55">é›¯é›¯ zc55</option>
                                </optgroup>
                                <optgroup label="ä¸­å±±åº— - å…¼è·">
                                    <option value="å°æœ zcdo">å°æœ zcdo</option>
                                    <option value="Reina zcre">Reina zcre</option>
                                </optgroup>
                                <optgroup label="ä¸­åŸåº— - æ­£è·">
                                    <option value="æ——æ—— zc77">æ——æ—— zc77</option>
                                    <option value="æŸ”æŸ” zc66">æŸ”æŸ” zc66</option>
                                </optgroup>
                                <optgroup label="ä¸­åŸåº— - å…¼è·">
                                    <option value="CC zcpt2">CC zcpt2</option>
                                    <option value="å°ç´œ zcpt3">å°ç´œ zcpt3</option>
                                </optgroup>
                                <optgroup label="æ–°ç«¹åº— - å…¼è·">
                                    <option value="å°çŸ³ zcpt4">å°çŸ³ zcpt4</option>
                                    <option value="Yuna zcpt5">Yuna zcpt5</option>
                                    <option value="è±è± zcpt6">è±è± zcpt6</option>
                                    <option value="å°å‰ zcpt7">å°å‰ zcpt7</option>
                                </optgroup>
                                <optgroup label="æ”¯æ´äººå“¡">
                                    <option value="æ”¯æ´ 1">æ”¯æ´ 1</option>
                                    <option value="æ”¯æ´ 2">æ”¯æ´ 2</option>
                                    <option value="æ”¯æ´ 3">æ”¯æ´ 3</option>
                                </optgroup>
                                <optgroup label="è©¦ä¸Šäººå“¡">
                                    <option value="è©¦ä¸Š 1">è©¦ä¸Š 1</option>
                                    <option value="è©¦ä¸Š 2">è©¦ä¸Š 2</option>
                                    <option value="è©¦ä¸Š 3">è©¦ä¸Š 3</option>
                                </optgroup>
                            </select>
                        </div>
                        <div><label>éŠ·å”®ä»¶æ•¸</label><input type="number" name="staff_count[]" value="0"></div>
                        <div><label>VIPé–‹ç™¼</label><input type="number" name="staff_vip[]" value="0" oninput="updateCheer(this)"></div>
                        <div><label>å±•ç¤ºç…§ç‰‡</label><input type="number" name="photo_show[]" value="0"></div>
                    </div>
                    <div class="cheer-msg px-1"></div>
                    <div class="grid grid-cols-3 gap-4">
                        <div><label>äººå“¡ç©¿æ­ (è²¨è™Ÿ)</label><input type="text" name="staff_outfit[]" placeholder="å¡«å¯«è²¨è™Ÿ"></div>
                        <div><label>è©¢å•æ¬¡æ•¸</label><input type="number" name="staff_ask[]" value="0"></div>
                        <div><label>è²·å–®æ¬¡æ•¸</label><input type="number" name="staff_buy[]" value="0"></div>
                    </div>
                </div>
            </div>
            <button type="button" onclick="addStaff()" class="flex items-center gap-2 text-sm text-pink-600 font-bold mb-6 hover:text-pink-700">
                <span class="text-lg">ï¼‹</span> æ–°å¢äººå“¡ç¸¾æ•ˆ
            </button>

            <!-- åˆ†æèˆ‡å›é¥‹ -->
            <div class="section-title"><span>âœï¸</span> åˆ†æèˆ‡å›é¥‹</div>
            <label>é–€åº—ç¾æ³åˆ†æ (ç’°å¢ƒã€å®¢ç¾¤ã€æ•ˆç‡)</label>
            <textarea name="analysis" rows="3" placeholder="ä»Šå¤©åº—è£¡ç™¼ç”Ÿäº†ä»€éº¼æœ‰è¶£æˆ–å€¼å¾—ç­†è¨˜çš„äº‹å—ï¼Ÿ"></textarea>
            
            <label>ä»Šæ—¥ç†±éŠ·æ’å (Top 5)</label>
            <div class="grid grid-cols-1 md:grid-cols-5 gap-2 mb-4">
                <input type="text" name="hot_item_1" placeholder="1. è²¨è™Ÿ/åç¨±">
                <input type="text" name="hot_item_2" placeholder="2. è²¨è™Ÿ/åç¨±">
                <input type="text" name="hot_item_3" placeholder="3. è²¨è™Ÿ/åç¨±">
                <input type="text" name="hot_item_4" placeholder="4. è²¨è™Ÿ/åç¨±">
                <input type="text" name="hot_item_5" placeholder="5. è²¨è™Ÿ/åç¨±">
            </div>

            <label>é–€å¸‚èª²ç¨‹è¨“ç·´é€²åº¦ (é¸å¡«)</label>
            <textarea name="training_progress" rows="2" placeholder="è‹¥ä»Šæ—¥æœ‰é€²è¡Œå“¡å·¥æ•™è‚²è¨“ç·´ï¼Œè«‹ç´€éŒ„å…§å®¹æˆ–é€²åº¦..."></textarea>

            <label>éœ€è£œå•†å“ / å‚™å“ / ç•°å¸¸äº‹é …</label>
            <textarea name="restock" rows="2" placeholder="è±¹ç´‹ç´™è¢‹å¤ å—ï¼Ÿæ˜¯å¦æœ‰æ±è¥¿éœ€è¦ç¶­ä¿®ï¼Ÿ"></textarea>

            <div class="section-title"><span>ğŸ’¡</span> é«˜å±¤å›é¥‹èˆ‡åœ˜éšŠåæ˜ </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-blue-50 p-4 rounded-2xl border border-blue-100 mb-4 md:mb-0">
                    <label class="text-blue-700">çµ¦è€é—† ALY çš„å›é¥‹åæ˜  ğŸ’¼</label>
                    <textarea name="feedback_aly" rows="3" placeholder="è€é—†éœ€è¦çŸ¥é“çš„äº‹é …èˆ‡å»ºè­°..."></textarea>
                </div>
                <div class="bg-purple-50 p-4 rounded-2xl border border-purple-100">
                    <label class="text-purple-700">çµ¦éšŠé•· Rita çš„å›é¥‹åæ˜  ğŸ‘‘</label>
                    <textarea name="feedback_rita" rows="3" placeholder="åœ˜éšŠé‹ä½œã€éœ€è¦éšŠé•·æ”¯æ´çš„äº‹é …..."></textarea>
                </div>
            </div>

            <div class="flex flex-col sm:flex-row gap-5 mt-8">
                <button type="submit" id="submitBtn" class="btn-primary flex-1 text-white font-bold py-5 rounded-2xl shadow-xl">å®Œæˆä¸¦é€å‡ºæ•¸æ“š ğŸš€</button>
                <button type="button" onclick="generatePreview()" class="flex-1 bg-gray-100 text-gray-700 font-bold py-5 rounded-2xl hover:bg-gray-200 transition">åƒ…é è¦½ LINE æ–‡å­— ğŸ“„</button>
            </div>
        </form>

        <div id="resultContainer" class="card p-6 md:p-8 hidden animate-in fade-in slide-in-from-bottom-4 duration-500">
            <h2 class="text-2xl font-bold mb-5 flex justify-between items-center text-pink-700">
                <span>ğŸ“‹ LINE å›å ±æ ¼å¼</span>
                <button onclick="copyToClipboard()" class="text-sm bg-pink-600 text-white px-5 py-2 rounded-full hover:bg-pink-700 shadow-md transition">è¤‡è£½æ•´ä»½å ±å‘Š</button>
            </h2>
            <pre id="resultText" class="whitespace-pre-wrap bg-pink-50/50 p-6 rounded-2xl border border-pink-100 text-gray-700 text-sm leading-relaxed"></pre>
        </div>
        
        <footer class="text-center mt-10 pb-10 text-pink-400 text-sm">
            ZC Performance System v2.8 â€¢ å·²ä¿®æ­£åˆ†äº«æ¨™é¡Œ
        </footer>
    </div>

    <script>
        // æ³¨æ„ï¼šç™¼å¸ƒå¾Œè‹¥ LINE æ¨™é¡Œæœªæ›´æ–°ï¼Œæ˜¯å› ç‚º LINE æœ‰å¿«å–ã€‚
        // è«‹åˆ° LINE å®˜æ–¹æª¢æ¸¬å·¥å…·ç¶²å€ï¼šhttps://poker.line.me/ è¼¸å…¥ç¶²å€æ¸…é™¤å¿«å–ã€‚
        const scriptURL = 'https://script.google.com/macros/s/AKfycby9QLEMRA_wJUFImeJqNyN-GXkNpFim1MYuPHCCy-HJctbUvHpnpVqVpKVkcuymu8kJhA/exec'; 

        document.getElementById('date').valueAsDate = new Date();
        const dayMap = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'];
        document.getElementById('weekday').value = dayMap[new Date().getDay()];

        function updateCheer(el) {
            const row = el.closest('.staff-group');
            const name = row.querySelector('.staff-select').value;
            const vip = parseInt(row.querySelector('input[name="staff_vip[]"]').value) || 0;
            const cheerMsg = row.querySelector('.cheer-msg');
            if (!name) { cheerMsg.style.display = 'none'; return; }
            cheerMsg.style.display = 'block';
            cheerMsg.innerText = vip > 0 ? `ğŸ”¥ å²å®³ï¼${name.split(' ')[0]} å·²ç¶“é–‹ç™¼ ${vip} ä½ VIP äº†ï¼` : `âœ¨ ${name.split(' ')[0]} ä»Šå¤©ä¹Ÿè¾›è‹¦äº†ï¼ŒåŠ æ²¹ï¼`;
        }

        function addStaff() {
            const container = document.getElementById('staffContainer');
            const sourceSelect = document.querySelector('.staff-select');
            const div = document.createElement('div');
            div.className = 'perf-row staff-group animate-in fade-in slide-in-from-right-4 duration-300';
            div.innerHTML = `
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                    <div><label>éŠ·å”®äººå“¡</label><select name="staff_name[]" class="staff-select" onchange="updateCheer(this)">${sourceSelect.innerHTML}</select></div>
                    <div><label>éŠ·å”®ä»¶æ•¸</label><input type="number" name="staff_count[]" value="0"></div>
                    <div><label>VIPé–‹ç™¼</label><input type="number" name="staff_vip[]" value="0" oninput="updateCheer(this)"></div>
                    <div><label>å±•ç¤ºç…§ç‰‡</label><input type="number" name="photo_show[]" value="0"></div>
                </div>
                <div class="cheer-msg px-1"></div>
                <div class="grid grid-cols-3 gap-4">
                    <div><label>äººå“¡ç©¿æ­ (è²¨è™Ÿ)</label><input type="text" name="staff_outfit[]" placeholder="å¡«å¯«è²¨è™Ÿ"></div>
                    <div><label>è©¢å•æ¬¡æ•¸</label><input type="number" name="staff_ask[]" value="0"></div>
                    <div><label>è²·å–®æ¬¡æ•¸</label><input type="number" name="staff_buy[]" value="0"></div>
                </div>
                <button type="button" onclick="this.parentElement.remove()" class="absolute top-4 right-4 text-gray-300 hover:text-red-400">âœ•</button>
            `;
            container.appendChild(div);
        }

        const form = document.getElementById('storeForm');
        form.addEventListener('submit', e => {
            e.preventDefault();
            document.getElementById('loadingOverlay').style.display = 'flex';
            document.getElementById('submitBtn').disabled = true;

            fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: new FormData(form)})
            .then(() => {
                document.getElementById('loadingOverlay').style.display = 'none';
                document.getElementById('submitBtn').disabled = false;
                generatePreview();
            })
            .catch(() => {
                document.getElementById('loadingOverlay').style.display = 'none';
                document.getElementById('submitBtn').disabled = false;
                generatePreview();
            });
        });

        function generatePreview() {
            const data = new FormData(form);
            const names = data.getAll('staff_name[]');
            const counts = data.getAll('staff_count[]');
            const vips = data.getAll('staff_vip[]');
            const photos = data.getAll('photo_show[]');
            const outfits = data.getAll('staff_outfit[]');
            const asks = data.getAll('staff_ask[]');
            const buys = data.getAll('staff_buy[]');
            
            let perfText = "";
            names.forEach((n, i) => { 
                if(n) {
                    perfText += `ãƒ»${n}: ${counts[i]} ä»¶ [VIP:+${vips[i]}] <ç…§:${photos[i]}>\n`; 
                    perfText += `  â”” ç©¿æ­:${outfits[i] || 'æœªå¡«'} / è©¢å•:${asks[i]} / è²·å–®:${buys[i]}\n`;
                }
            });

            let hotItems = "";
            for(let i=1; i<=5; i++) {
                const item = data.get(`hot_item_${i}`);
                if(item) hotItems += `${i}. ${item}\n`;
            }

            let report = `âœ¨ ã€Š${data.get('store_name')}ã€‹æ¥­ç¸¾ç¸¾æ•ˆå›å ± âœ¨\n`;
            report += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
            report += `ğŸ“… æ—¥æœŸï¼š${data.get('date')} (${data.get('weekday')})\n`;
            report += `ğŸ‘¥ é€²åº—äººæµï¼š${data.get('visitor_count')} äºº\n`;
            report += `ğŸ“¦ ç¸½ä»¶/ç­†æ•¸ï¼š${data.get('total_items')} / ${data.get('total_orders')}\n`;
            report += `ğŸ’ å…¨åº— VIP é–‹ç™¼ï¼š${data.get('total_vip_all')}\n\n`;
            report += `ã€Š å€‹äººç¸¾æ•ˆæ˜ç´° ğŸ’ƒ ã€‹\n${perfText}\n`;
            report += `ã€Š é–€åº—ç¾æ³åˆ†æ ğŸ“ ã€‹\n${data.get('analysis') || 'ç„¡'}\n\n`;
            report += `ã€Š ä»Šæ—¥ç†±éŠ·æ’å ğŸ”¥ ã€‹\n${hotItems || 'ç„¡'}\n`;
            report += `ã€Š èª²ç¨‹è¨“ç·´é€²åº¦ ğŸ“ ã€‹\n${data.get('training_progress') || 'ç„¡'}\n\n`;
            report += `ã€Š è£œè²¨èˆ‡ç•°å¸¸ âš ï¸ ã€‹\n${data.get('restock') || 'ç„¡'}\n\n`;
            report += `ã€Š è€é—† ALY åæ˜  ğŸ’¼ ã€‹\n${data.get('feedback_aly') || 'ç„¡'}\n\n`;
            report += `ã€Š åœ˜éšŠ Rita åæ˜  ğŸ‘‘ ã€‹\n${data.get('feedback_rita') || 'ç„¡'}\n`;
            report += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
            report += `ğŸ’• è¾›è‹¦å¤§å®¶äº†ï¼ä»Šå¤©ä¹Ÿæ˜¯æ£’æ£’çš„ä¸€å¤©ï¼`;

            document.getElementById('resultText').innerText = report;
            document.getElementById('resultContainer').classList.remove('hidden');
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        }

        function copyToClipboard() {
            const text = document.getElementById('resultText').innerText;
            const el = document.createElement('textarea');
            el.value = text; document.body.appendChild(el); el.select();
            document.execCommand('copy'); document.body.removeChild(el);
            
            const btn = event.target;
            const originalText = btn.innerText;
            btn.innerText = "âœ… å·²è¤‡è£½ï¼";
            btn.classList.replace('bg-pink-600', 'bg-green-500');
            setTimeout(() => {
                btn.innerText = originalText;
                btn.classList.replace('bg-green-500', 'bg-pink-600');
            }, 2000);
        }
    </script>
</body>
</html>
